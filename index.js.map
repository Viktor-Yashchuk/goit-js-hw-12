{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst searchPhotos = axios.create({\n    baseURL: 'https://pixabay.com/api/',\n    params: {\n        key: import.meta.env.VITE_PIXABAY_KEY,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n    },\n});\n\nexport async function getImagesByQuery(query, currentPage) {\n    try {\n        const res = await searchPhotos.get('', { params: { q: query, page: currentPage } });\n        return res.data;\n    } catch (error) {\n        throw error;\n        }\n}\n\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport const refs = {\n    galleryEl: document.querySelector('.gallery'),\n    loaderEl: document.querySelector('.loader'),\n    btnLoadEl: document.querySelector('.btn-load-more'),\n    formEl: document.querySelector('.form')\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n    captionPosition: 'bottom',\n    captions: true,\n    });\n\nexport function createGallery(images) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n    </a>\n    <dl class=\"gallery-stats-list\">\n        <dt class=\"title\">Likes</dt><dd class=\"numbers\">${likes}</dd>\n        <dt class=\"title\">Views</dt><dd class=\"numbers\">${views}</dd>\n        <dt class=\"title\">Comments</dt><dd class=\"numbers\">${comments}</dd>\n        <dt class=\"title\">Downloads</dt><dd class=\"numbers\">${downloads}</dd>\n    </dl>\n        </li>`).join('');\n    \n    refs.galleryEl.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n}\n\nexport function clearGallery() {\n    refs.galleryEl.innerHTML = '';\n}\n\nexport function showLoader() {\n    refs.loaderEl.classList.remove('hidden');\n    refs.loaderEl.setAttribute('aria-busy', 'true');\n}\n\nexport function hideLoader() {\n    refs.loaderEl.classList.add('hidden');\n    refs.loaderEl.setAttribute('aria-busy', 'false');\n}\n\nexport function showLoadMoreButton() {\n    refs.btnLoadEl.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton() {\n    refs.btnLoadEl.classList.add('hidden');\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from \"./js/pixabay-api\";\nimport { clearGallery, createGallery, hideLoader, hideLoadMoreButton, refs, showLoader, showLoadMoreButton } from \"./js/render-functions\";\n\nlet currentPage;\nlet query;\nlet maxPages;\n\nrefs.formEl.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget);\n    query = (formData.get('search-text') || '').trim();\n    if (!query) {\n        iziToast.warning({\n            message: 'Please enter a search query',\n            position: 'topRight',\n        });\n        return;\n    }\n    showLoader();\n    clearGallery();\n    hideLoadMoreButton();\n    currentPage = 1;\n    try {\n        const { hits, totalHits } = await getImagesByQuery(query, currentPage);\n        const perPage = 15;\n        maxPages = Math.ceil(totalHits / perPage);\n        if (!hits.length) {\n            iziToast.info({\n                message: 'Sorry, there are no images matching <br> your search query. Please try again!',\n                position: 'topRight',\n                backgroundColor: '#ef4040',\n                progressBarColor: '#b51b1b',\n            });\n            return;\n        }\n        createGallery(hits);\n        if (maxPages > 1) {\n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton()\n        }\n    }\n        catch (error) {\n            iziToast.error({\n                message: 'Something went wrong.',\n                position: 'topRight',\n            });\n        }\n        finally {\n            hideLoader();  \n            refs.formEl.reset();\n        }\n});\n\nrefs.btnLoadEl.addEventListener('click', async () => {\n    currentPage += 1;\n    hideLoadMoreButton();\n    showLoader();\n    try {\n        const { hits } = await getImagesByQuery(query, currentPage);\n        createGallery(hits);\n        const { height: cardHeight } = document.querySelector('.gallery').firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth',\n        });\n        if (currentPage < maxPages) {\n            showLoadMoreButton();\n        } else {\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n                backgroundColor: '#ef4040',\n                progressBarColor: '#b51b1b',\n            });\n        }\n    } catch (error) {\n        iziToast.error({\n            message: 'Something went wrong.',\n            position: 'topRight',\n        });\n        showLoadMoreButton();\n    }\n    finally {\n        hideLoader();\n    }\n});\n"],"names":["searchPhotos","axios","getImagesByQuery","query","currentPage","error","refs","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","maxPages","e","iziToast","hits","totalHits","cardHeight"],"mappings":"owBAEA,MAAMA,EAAeC,EAAM,OAAO,CAC9B,QAAS,2BACT,OAAQ,CACJ,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,EACd,CACJ,CAAC,EAEqB,eAAAC,EAAiBC,EAAOC,EAAa,CACnD,GAAA,CAEA,OADY,MAAMJ,EAAa,IAAI,GAAI,CAAE,OAAQ,CAAE,EAAGG,EAAO,KAAMC,CAAA,CAAe,CAAA,GACvE,WACNC,EAAO,CACN,MAAAA,CACN,CACR,CCjBO,MAAMC,EAAO,CAChB,UAAW,SAAS,cAAc,UAAU,EAC5C,SAAU,SAAS,cAAc,SAAS,EAC1C,UAAW,SAAS,cAAc,gBAAgB,EAClD,OAAQ,SAAS,cAAc,OAAO,CAC1C,EAEMC,EAAW,IAAIC,EAAe,aAAc,CAC9C,aAAc,MACd,aAAc,IACd,gBAAiB,SACjB,SAAU,EACd,CAAK,EAEE,SAASC,EAAcC,EAAQ,CAClC,MAAMC,EAASD,EAAO,IAAI,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAC/F;AAAA,oCAC4BL,CAAa;AAAA,sCACXD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,0DAGNC,CAAK;AAAA,0DACLC,CAAK;AAAA,6DACFC,CAAQ;AAAA,8DACPC,CAAS;AAAA;AAAA,cAEzD,EAAE,KAAK,EAAE,EAEnBZ,EAAK,UAAU,mBAAmB,YAAaK,CAAM,EACrDJ,EAAS,QAAO,CACpB,CAEO,SAASY,GAAe,CAC3Bb,EAAK,UAAU,UAAY,EAC/B,CAEO,SAASc,GAAa,CACzBd,EAAK,SAAS,UAAU,OAAO,QAAQ,EACvCA,EAAK,SAAS,aAAa,YAAa,MAAM,CAClD,CAEO,SAASe,GAAa,CACzBf,EAAK,SAAS,UAAU,IAAI,QAAQ,EACpCA,EAAK,SAAS,aAAa,YAAa,OAAO,CACnD,CAEO,SAASgB,GAAqB,CACjChB,EAAK,UAAU,UAAU,OAAO,QAAQ,CAC5C,CAEO,SAASiB,GAAqB,CACjCjB,EAAK,UAAU,UAAU,IAAI,QAAQ,CACzC,CCjDA,IAAIF,EACAD,EACAqB,EAEJlB,EAAK,OAAO,iBAAiB,SAAU,MAAOmB,GAAM,CAIhD,GAHAA,EAAE,eAAc,EAEhBtB,GADiB,IAAI,SAASsB,EAAE,aAAa,EAC3B,IAAI,aAAa,GAAK,IAAI,OACxC,CAACtB,EAAO,CACRuB,EAAS,QAAQ,CACb,QAAS,8BACT,SAAU,UACtB,CAAS,EACD,MACH,CACDN,IACAD,IACAI,IACAnB,EAAc,EACd,GAAI,CACA,KAAM,CAAE,KAAAuB,EAAM,UAAAC,CAAW,EAAG,MAAM1B,EAAiBC,EAAOC,CAAW,EAGrE,GADAoB,EAAW,KAAK,KAAKI,EADL,EACwB,EACpC,CAACD,EAAK,OAAQ,CACdD,EAAS,KAAK,CACV,QAAS,gFACT,SAAU,WACV,gBAAiB,UACjB,iBAAkB,SAClC,CAAa,EACD,MACH,CACDjB,EAAckB,CAAI,EACdH,EAAW,EACXF,IAEAC,EAAoB,CAE3B,MACiB,CACVG,EAAS,MAAM,CACX,QAAS,wBACT,SAAU,UAC1B,CAAa,CACJ,QACO,CACJL,IACAf,EAAK,OAAO,OACf,CACT,CAAC,EAEDA,EAAK,UAAU,iBAAiB,QAAS,SAAY,CACjDF,GAAe,EACfmB,IACAH,IACA,GAAI,CACA,KAAM,CAAE,KAAAO,CAAI,EAAK,MAAMzB,EAAiBC,EAAOC,CAAW,EAC1DK,EAAckB,CAAI,EAClB,KAAM,CAAE,OAAQE,CAAU,EAAK,SAAS,cAAc,UAAU,EAAE,kBAAkB,wBACpF,OAAO,SAAS,CACZ,IAAKA,EAAa,EAClB,SAAU,QACtB,CAAS,EACGzB,EAAcoB,EACdF,IAEAI,EAAS,KAAK,CACV,QAAS,6DACT,SAAU,WACV,gBAAiB,UACjB,iBAAkB,SAClC,CAAa,CAER,MAAe,CACZA,EAAS,MAAM,CACX,QAAS,wBACT,SAAU,UACtB,CAAS,EACDJ,GACH,QACO,CACJD,GACH,CACL,CAAC"}